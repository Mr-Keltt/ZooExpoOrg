@using ZooExpoOrg.Web.Services.Expositions;
@using ZooExpoOrg.Web.Services.GetIdHelper;
@using ZooExpoOrg.Web.Shared.Components
@using ZooExpoOrg.Web.Shared.Layouts;

@inject IGetIdHelperService GetIdHelper
@inject IExpositionService ExpositionService
@inject NavigationManager NavigationManager

@page "/"
@layout MainLayout

<MudGrid Justify="Justify.Center" Class="pa-10">
    <MudItem xs="10" sm="8">
        <MudPaper Class="pa-4">
            <MudText Typo="Typo.h4" GutterBottom="true"><b>Выставки</b></MudText>

            @if (expositions.Count > 0)
            {
                @foreach (VueExpositionModel exposition in expositions)
                {
                <ExpositionCard Exposition="@exposition"/>
                }
            }
        </MudPaper>
    </MudItem>
</MudGrid>

@code {
    private List<VueExpositionModel> expositions = new List<VueExpositionModel>();

    protected override async Task OnInitializedAsync()
    {
        await ExpositionDataReload();
    }

    private async Task ExpositionDataReload()
    {
        var getExpositionsResult = await ExpositionService.GetExpositions();

        if (!getExpositionsResult.Successful)
        {
            return;
        }

        expositions = getExpositionsResult.Result;

        StateHasChanged();
    }
}